/*! Riloadr.js 1.4.0 (c) 2013 Tubal Martin - MIT license */
!function(a){"function"==typeof define&&define.amd?define(a):window.Riloadr=a()}(function(){"use strict";function pb(a){function fb(){ib=tb(),X=qb(i,ib,I),ab=sb(i,X[B]),eb=E&&F&&jb(X,bb.max)}function jb(a,b){return a.name===b.name&&a[x]===b[x]&&a[y]===b[y]&&a[W]===b[W]&&a[D]===b[D]}function lb(a,b){var c=+a[W]||1,d=+b[W]||1;return a=Math.max(+a[x]||0,+a[y]||0)*(kb>=c?c:1),b=Math.max(+b[x]||0,+b[y]||0)*(kb>=d?d:1),a>b}function pb(a,b){if(Kb(Z,t,P),M&&(Kb(Z,q,O),hb&&(ob=Z[N],Kb(Z,V,R)),s))for(b=0;a=s[b];)Kb($[Q](a),q,O),b++}function wb(a,b){if(E||Lb(Z,t,P),M&&!E){if(Lb(Z,q,O),s)for(b=0;a=s[b];)Lb($[Q](a),q,O),b++;hb&&Lb(Z,V,R)}}function xb(a,b){a[w]=0,a[B]=f,a[u]=yb,a[v]=zb,a.src=ub(a,e,X),S.splice(b,1)}function yb(){var b=this;b[u]=b[v]=h,b[A]&&(b[C]=b[C].replace(l,"$1$2")),M&&(b.style.visibility="visible"),u in a&&a[u][j](b),Ab()}function zb(){var b=this;v in a&&a[v][j](b),J>b[w]?(b[w]++,b.src=ub(b,e,b[B]?ab:X,c)):B in X&&!b[B]?(b[w]=0,b[B]=c,b.src=ub(b,e,ab)):Ab()}function Ab(){U--,0==U&&(wb(),H in a&&a[H]())}var X,_,ab,bb,cb,db,eb,b=this,e=a.base||n,i=a.breakpoints||Jb('"breakpoints" not defined.'),k=a.name||"responsive",l=RegExp("(^|\\s)"+k+"(\\s|$)"),m=a.defer&&("string"==typeof a.defer?{mode:a.defer,threshold:a.foldDistance,overflownElemsIds:[]}:a.defer),o=m&&m.mode.toLowerCase(),r=m&&m.threshold||100,s=m&&m.overflownElemsIds,z=a.watchViewportWidth,E=!!z,F="wider"==z,G="*"==z,I=a.ignoreLowBandwidth||f,J=a[w]||0,L=a.root||h,M=("invisible"==o||"belowfold"==o)&&!mb,O=M&&Fb(function(){b[K]()},g),P=(M||E)&&Gb(function(){E&&fb(),b[K](E)},g),R=M&&Gb(function(){Z[N]!==ob&&(ob=Z[N],b[K]())},g),S=[],U=0;b[K]=function(a){Ib(function(b,d,e){if(!S[p]||a===c){for(a&&pb(),E&&_&&(cb=!jb(X,_),db=F&&lb(X,_)),b=gb&&L[T]("img."+k)||L.getElementsByTagName("img"),e=0;d=b[e];)d&&!d[A]&&(gb||d[C].indexOf(k)>=0)&&((!E||E&&(!_||F&&db||G&&cb))&&(S.push(d),U++),(!E||eb)&&(d[A]=c)),e++;eb&&(E=f),E&&(_=X)}if(S[p])for(e=0;d=S[e];)d&&(!M||M&&vb(d,r))&&(xb(d,e),e--),e++;b=d=h})},nb(function(){Y=$[d],L=$[Q](L)||Y,bb=E&&rb(i),fb(),(M||E)&&pb(),!o||M?b[K]():Mb(b[K])})}function qb(a,b,c){for(var g,h,i,j,d=b,e=0,f={};g=a[e];)h=g[x],i=g[y],j=g[W],b>0?(h&&i&&b>=h&&i>=b||h&&!i&&b>=h||i&&!h&&i>=b)&&(!j||j&&kb>=j&&(c||!c&&!lb))&&(f=g):(0>=d||d>h||d>i)&&(d=h||i||d,f=g),e++;return f}function rb(a){for(var g,h,i,j,k,l,b=0,c=0,d=1/0,e={},f={};g=a[b];)j=+g[x]||0,k=+g[y]||0,l=+g[W]||1,kb>=l&&(j*=l,k*=l),h=j&&k&&Math.min(j,k)||j||k,i=j&&k&&Math.max(j,k)||k||j,d>h&&(d=h,e=g),i>c&&(c=i,f=g),b++;return{min:e,max:f}}function sb(a,b,c,d){if(typeof b==F)return{};for(d=0;c=a[d];){if(c.name==b)return c;d++}}function tb(){for(var f,a=Math,b=[_.clientWidth,_.offsetWidth,Y.clientWidth],c=a.ceil(jb/kb),d=b[p],e=0;d>e;e++)isNaN(b[e])&&(b.splice(e,1),e--);return b[p]&&(f=a.max[k](a,b),isNaN(c)||(f=a.min(c,f))),f||c||0}function ub(a,b,c,d){var e=(a.getAttribute("data-base")||b)+(a.getAttribute("data-src")||n);return c[D]&&(e=e.split("."),e.pop(),e=e.join(".")+"."+c[D]),d&&(e+=(eb.test(e)?"&":"?")+"riloadrts="+(new Date).getTime()),e.replace(fb,c.name)}function lb(){var a=Z.navigator,b=a.connection||a.mozConnection||a.webkitConnection||a.oConnection||a.msConnection||{},c=b.type||"unknown",d=+b.bandwidth||1/0;return d>0&&.1>d||/^[23]g|3|4$/.test(c+n)}function vb(a,b){return!(yb(a,b)||zb(a,b)||wb(a,b)||xb(a,b))}function wb(a,c){return Cb(o,Z)+Bb(b,Z)<=Ab(b,a)-c}function xb(a,c){return Bb(b,Z)>=Ab(b,a)+c+Cb(o,a)}function yb(a,b){return Cb(m,Z)+Bb(e,Z)<=Ab(e,a)-b}function zb(a,b){return Bb(e,Z)>=Ab(e,a)+b+Cb(m,a)}function Ab(a,c){var g,h,d={top:0,left:0},f=c&&c.ownerDocument;if(f)return g=f[R],typeof c[X]!==F&&(d=c[X]()),Z=Eb(f),h={top:d[b]+(Z[L]||g[G])-(g.clientTop||0),left:d[e]+(Z[M]||g[J])-(g.clientLeft||0)},h[a]}function Bb(a,b){var c={top:{method:G,prop:L},left:{method:J,prop:M}},d=c[a].method,e=c[a].prop,f=Eb(b);return f?e in f?f[e]:_[d]:b[d]}function Cb(a,b){var e,f,g,c={height:"Height",width:"Width"};return a=c[a],Db(b)?_[s+a]:9===b.nodeType?(e=b[R],Math.max(b[d][q+a],e[q+a],b[d][r+a],e[r+a],e[s+a])):(f=b[r+a],a=a.toLowerCase(),(0>=f||f==h)&&(Z.getComputedStyle?g=Z.getComputedStyle(b,h):docElem.currentStyle&&(g=b.currentStyle),g&&(f=g[a]),(0>f||f==h)&&(f=b.style[a])),parseFloat(f)||0)}function Db(a){return a!=h&&a==a.window}function Eb(a){return Db(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:f}function Fb(a,b){function i(){g=new Date,f=h,a[k](e,c)}var c,d,e,f,g=0;return function(){var h=new Date,j=b-(h-g);return c=arguments,e=this,0>=j?(g=h,d=a[k](e,c)):f||(f=Hb(i,j)),d}}function Gb(a,b,c){function i(){g=h,c||a[k](f,d)}var d,e,f,g;return function(){var h=c&&!g;return d=arguments,f=this,clearTimeout(g),g=Hb(i,b),h&&(e=a[k](f,d)),e}}function Hb(a,b){var c=Array[E].slice[j](arguments,2);return Z.setTimeout(function(){return a[k](h,c)},b)}function Ib(a){return Hb[k](h,[a,1].concat(Array[E].slice[j](arguments,1)))}function Jb(a){throw Error("Riloadr: "+a)}function Kb(a,b,c){a[cb](bb+b,c,f)}function Lb(a,b,c){a[db](bb+b,c,f)}function Mb(a){if($[I]===z)Ib(a);else{var b=function(){Lb(Z,i,b),Ib(a)};Kb(Z,i,b)}}var Y,ib,nb,ob,a="on",b="top",c=!0,d="body",e="left",f=!1,g=250,h=null,i="load",j="call",k="apply",l="error",m="width",n="",o="height",p="length",q="scroll",r="offset",s="client",t="resize",u=a+i,v=a+l,w="retries",x="minWidth",y="maxWidth",z="complete",A="riloaded",B="fallback",C="className",D="imgFormat",E="prototype",F="undefined",G=q+"Top",H=a+z,I="readyState",J=q+"Left",K=i+"Images",L="pageYOffset",M="pageXOffset",N="orientation",O="attachEvent",P="EventListener",Q="getElementById",R="documentElement",S="readystatechange",T="querySelectorAll",U="add"+P,V=N+"change",W="minDevicePixelRatio",X="getBoundingClientRect",Z=window,$=Z.document,_=$[R],ab=U in $,bb=ab?n:a,cb=ab?U:O,db=ab?"remove"+P:"detachEvent",eb=/\?/,fb=/{breakpoint-name}/gi,gb=T in $,hb=N in Z&&a+V in Z,jb=Z.screen[m],kb=Z.devicePixelRatio||1,lb=lb(),mb="[object OperaMini]"===Object[E].toString[j](Z.operamini);return _[C]=_[C].replace(/(^|\s)no-js(\s|$)/,"$1$2"),pb.version="1.4.0",pb[E].riload=function(){this[K](c)},nb=function(){function j(a){if(!e){if(!$[d])return Ib(j);for(e=c;a=g.shift();)Ib(a)}}function k(a){(ab||a.type===i||$[I]===z)&&(l(),j())}function l(){Lb($,ab?a:S,k),Lb(Z,i,k)}var a="DOMContentLoaded",b=f,e=f,g=[];if($[I]===z)Ib(j);else{if(ab)Kb($,a,k);else{Kb($,S,k);try{b=Z.frameElement==h&&docElem}catch(m){}b&&b.doScroll&&function n(){if(!e){try{b.doScroll("left")}catch(a){return Hb(n,50)}l(),j()}}()}Kb(Z,i,k)}return function(a){e?Ib(a):g.push(a)}}(),pb});